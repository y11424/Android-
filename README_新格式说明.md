# 大乐透历史开奖号码新格式说明

## 概述
已成功修改历史开奖号码的格式，现在支持期号和开奖日期信息，完全符合图片中显示的格式要求。新增期号自动生成和日期选择器功能。

## 新数据格式

### 数据结构
每条开奖记录现在包含以下字段：
- **期号**：5位数字，如 "25001"（前两位是年份后两位，后三位是序号）
- **开奖日期**：YYYY-MM-DD格式，如 "2025-08-11"
- **前区号码**：5个号码，格式为 "01 19 22 25 27"
- **后区号码**：2个号码，格式为 "03 10"

### 期号自动生成规则
- **格式**：YYNNN（Y=年份后两位，N=三位序号）
- **示例**：
  - 2024年：24001, 24002, 24003...
  - 2025年：25001, 25002, 25003...
- **自动递增**：系统会根据当前年份和已有期号自动生成下一期序号

### 存储格式
内部存储格式为：`期号|开奖日期|前区号码|后区号码;`

### CSV导入/导出格式
CSV文件包含9列：
```
期号,开奖日期,前区1,前区2,前区3,前区4,前区5,后区1,后区2
25001,2025-01-01,1,19,22,25,27,3,10
```

## 主要修改内容

### 1. LotteryEntry类
- 新增 `issueNumber` 和 `drawDate` 字段
- 新增 `generateIssueNumber()` 静态方法，自动生成期号
- 新增 `getCurrentDate()` 静态方法，获取当前日期
- 新增格式化方法 `getFrontNumbersString()` 和 `getBackNumbersString()`
- 保持向后兼容性

### 2. 用户界面
- 输入对话框自动生成期号（可修改）
- 日期字段改为日期选择器，默认为当日
- 历史数据显示包含期号和开奖日期信息
- 编辑对话框支持修改期号和开奖日期

### 3. 数据管理
- 存储和加载方法支持新格式
- CSV导入/导出功能更新
- 向后兼容旧格式数据
- 期号自动递增逻辑

### 4. 趋势图
- 统计信息显示期号范围
- 支持新格式数据的加载和显示

## 使用示例

### 输入新开奖数据
1. 点击"存入"按钮
2. 期号自动生成（如：25001），可以手动修改
3. 点击日期字段选择开奖日期（默认为当日）
4. 输入前区号码（如：01 19 22 25 27）
5. 输入后区号码（如：03 10）
6. 点击"存入"

### 期号生成示例
- 2024年第一次存入：24001
- 2024年第二次存入：24002
- 2025年第一次存入：25001
- 2025年第二次存入：25002

### 导入CSV数据
1. 准备CSV文件，格式如示例
2. 点击"查看全部" -> "导入"
3. 选择CSV文件
4. 系统自动导入并显示

### 导出数据
1. 点击"查看全部" -> "导出"
2. 系统生成包含期号和开奖日期的CSV文件

## 兼容性
- 完全兼容旧格式数据
- 旧数据会自动转换为新格式（期号和开奖日期为空）
- 可以逐步完善旧数据的期号和开奖日期信息

## 示例数据
参考 `sample_data_new_format.csv` 文件，包含10期示例数据，格式完全符合图片要求。

## 新功能特点
- ✅ 期号自动生成，格式为YYNNN
- ✅ 日期选择器，方便选择开奖日期
- ✅ 期号可手动修改
- ✅ 自动递增序号
- ✅ 年份自动识别
